<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <title>SecureScope</title>
    <style>
        :root {
            --bg-frame: #dfe3e8;
            --bg-toolbar: #ffffff;
            --bg-tab-active: #ffffff;
            --text-color: #1a1a1a;
            --accent-color: #0067c0;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            font-family: "Segoe UI Variable", "Segoe UI", sans-serif;
            background: var(--bg-toolbar);
            display: flex;
            flex-direction: column;
            user-select: none;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                width: 0;
                padding: 0;
                margin: 0;
            }
        }

        #titlebar {
            height: 42px;
            background: var(--bg-frame);
            display: flex;
            align-items: flex-end;
            padding-left: 8px;
            padding-right: 145px;
            -webkit-app-region: drag;
            position: relative;
            z-index: 100;
        }

        #tabs-container {
            flex: 1;
            display: flex;
            align-items: flex-end;
            height: 100%;
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-app-region: no-drag;
        }

        .tab {
            height: 34px;
            min-width: 140px;
            max-width: 220px;
            background: transparent;
            border-radius: 8px 8px 0 0;
            margin-right: 2px;
            padding: 0 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #4b4b4b;
            cursor: default;
            position: relative;
            animation: slideIn 0.2s ease-out;
            transition: background 0.2s;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .tab.active {
            background: var(--bg-tab-active);
            color: var(--text-color);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
            z-index: 10;
            font-weight: 600;
        }

        .tab:not(.active):not(:hover)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 8px;
            bottom: 8px;
            width: 1px;
            background: #a0a0a0;
            opacity: 0.3;
        }

        .tab.closing {
            animation: fadeOut 0.2s forwards;
            pointer-events: none;
        }

        .tab-text {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tab-close {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.2s;
            cursor: pointer;
            color: #666;
        }

        .tab:hover .tab-close {
            opacity: 1;
            transform: scale(1);
        }

        .tab-close:hover {
            background: #e0e0e0;
            color: #333;
        }

        .tab-close svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }

        .tab.blackbox {
            min-width: 46px !important;
            max-width: 46px !important;
            background: #f0f2f5;
            justify-content: center;
            padding: 0;
            margin-right: 6px;
        }

        .tab.blackbox:hover {
            background: #e5e7eb;
        }

        .tab.blackbox.active {
            background: #ffffff;
            color: var(--accent-color);
        }

        .tab.blackbox svg {
            fill: #5f6368;
            width: 18px;
            height: 18px;
            transition: fill 0.2s;
        }

        .tab.blackbox.active svg {
            fill: var(--accent-color);
        }

        .tab.blackbox::after {
            display: none;
        }

        .tab.blackbox .tab-close {
            display: none;
        }

        #new-tab-btn {
            width: 32px;
            height: 32px;
            border-radius: 4px;
            border: none;
            background: transparent;
            margin-left: 4px;
            margin-bottom: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4b4b4b;
            flex-shrink: 0;
            transition: background 0.2s;
        }

        #new-tab-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: black;
        }

        #new-tab-btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        #navbar {
            height: 44px;
            background: var(--bg-toolbar);
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            padding: 0 12px;
            gap: 8px;
            -webkit-app-region: no-drag;
            position: relative;
            z-index: 10;
        }

        .nav-btn {
            width: 34px;
            height: 34px;
            border-radius: 6px;
            border: none;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #5f5f5f;
            cursor: pointer;
            transition: background 0.1s;
        }

        .nav-btn:hover:not(:disabled) {
            background: #f0f0f0;
            color: black;
        }

        .nav-btn:active:not(:disabled) {
            background: #e0e0e0;
            transform: scale(0.96);
        }

        .nav-btn:disabled {
            color: #d0d0d0;
            cursor: default;
        }

        .nav-btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        #omnibox {
            flex: 1;
            height: 32px;
            background: #f3f3f3;
            border: 2px solid transparent;
            border-radius: 6px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            transition: all 0.2s;
        }

        #omnibox:focus-within {
            background: white;
            border-color: var(--accent-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        #omnibox:hover:not(:focus-within) {
            background: #eaeaea;
        }

        #secure-icon-wrapper {
            display: flex;
            align-items: center;
            margin-right: 10px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
        }

        #secure-icon-wrapper:hover {
            background: #e5e7eb;
        }

        #secure-icon {
            width: 14px;
            height: 14px;
            fill: #606060;
        }

        #secure-icon-wrapper:hover #secure-icon {
            fill: var(--accent-color);
        }

        #url-input {
            flex: 1;
            border: none;
            background: transparent;
            outline: none;
            font-size: 14px;
            color: #1a1a1a;
        }
    </style>
</head>

<body>
    <div id="titlebar">
        <div id="tabs-container">
            <button id="new-tab-btn" title="Nueva Pestaña"><svg viewBox="0 0 24 24">
                    <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
                </svg></button>
        </div>
    </div>
    <div id="navbar">
        <button class="nav-btn" id="btn-back" disabled title="Atrás"><svg viewBox="0 0 24 24">
                <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
            </svg></button>
        <button class="nav-btn" id="btn-fwd" disabled title="Adelante"><svg viewBox="0 0 24 24">
                <path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
            </svg></button>
        <button class="nav-btn" id="btn-reload" title="Recargar"><svg viewBox="0 0 24 24">
                <path
                    d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z" />
            </svg></button>
        <div id="omnibox">
            <div id="secure-icon-wrapper" title="Ver Estado de Seguridad (Auditoría)"><svg id="secure-icon"
                    viewBox="0 0 24 24">
                    <path
                        d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" />
                </svg></div>
            <input type="text" id="url-input" placeholder="Buscar o escribir URL">
        </div>
    </div>
    <script>
        const { ipcRenderer } = require('electron');
        const tabsContainer = document.getElementById('tabs-container');
        const newTabBtn = document.getElementById('new-tab-btn');
        const urlInput = document.getElementById('url-input');
        const secureIcon = document.getElementById('secure-icon-wrapper');

        newTabBtn.onclick = () => ipcRenderer.send('new-tab');
        document.getElementById('btn-back').onclick = () => ipcRenderer.send('go-back');
        document.getElementById('btn-fwd').onclick = () => ipcRenderer.send('go-forward');
        document.getElementById('btn-reload').onclick = () => ipcRenderer.send('reload');
        secureIcon.onclick = () => ipcRenderer.send('switch-tab', 'BLACKBOX');

        urlInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') { ipcRenderer.send('navigate', urlInput.value); urlInput.blur(); } });
        urlInput.addEventListener('focus', () => urlInput.select());

        ipcRenderer.on('blackbox-created', () => {
            const el = document.createElement('div'); el.className = 'tab blackbox'; el.id = 'tab-BLACKBOX'; el.title = 'Audit Log';
            el.innerHTML = `<svg viewBox="0 0 24 24"><path d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z" /></svg>`;
            el.onclick = () => ipcRenderer.send('switch-tab', 'BLACKBOX'); tabsContainer.prepend(el);
        });

        function createTab(id) {
            const el = document.createElement('div'); el.className = 'tab'; el.id = `tab-${id}`;
            el.innerHTML = `<span class="tab-text">Cargando...</span><div class="tab-close" onclick="closeTab(event, '${id}')" title="Cerrar Contenedor"><svg viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg></div>`;
            el.onclick = () => ipcRenderer.send('switch-tab', id); el.onauxclick = (e) => { if (e.button === 1) closeTab(e, id); };
            tabsContainer.insertBefore(el, newTabBtn); el.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        window.closeTab = (e, id) => { e.stopPropagation(); const el = document.getElementById(`tab-${id}`); if (el) { el.classList.add('closing'); setTimeout(() => { el.remove(); ipcRenderer.send('close-tab', id); }, 200); } };

        ipcRenderer.on('tab-created', (e, id) => createTab(id));
        ipcRenderer.on('tab-active', (e, id) => { document.querySelectorAll('.tab').forEach(t => t.classList.remove('active')); const active = document.getElementById(`tab-${id}`); if (active) { active.classList.add('active'); active.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); } });
        ipcRenderer.on('update-url', (e, url) => urlInput.value = url);
        ipcRenderer.on('update-tab-info', (e, data) => { const el = document.getElementById(`tab-${data.id}`); if (el) el.querySelector('.tab-text').innerText = data.title; });
        ipcRenderer.on('update-nav-state', (e, state) => { document.getElementById('btn-back').disabled = !state.canGoBack; document.getElementById('btn-fwd').disabled = !state.canGoForward; });
    </script>
</body>

</html>